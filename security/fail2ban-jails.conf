# Fail2ban Yapılandırması
# Bu dosya Fail2ban jail'lerini tanımlar

[DEFAULT]
# Genel ayarlar
bantime = 3600        # Ban süresi (saniye)
findtime = 600         # Hata sayımı için zaman aralığı
maxretry = 3           # Maksimum deneme sayısı
backend = auto         # Backend türü
banaction = ufw        # Ban aksiyonu (UFW kullan)
banaction_allports = ufw

# Nginx HTTP Auth koruması
[nginx-http-auth]
enabled = true
filter = nginx-http-auth
logpath = /var/log/nginx/nginx-demo-error.log
maxretry = 3
bantime = 7200        # 2 saat ban
findtime = 600

# Nginx bot arama koruması
[nginx-botsearch]
enabled = true
filter = nginx-botsearch
logpath = /var/log/nginx/nginx-demo-access.log
maxretry = 5
bantime = 3600
findtime = 300

# Nginx rate limiting koruması
[nginx-limit-req]
enabled = true
filter = nginx-limit-req
logpath = /var/log/nginx/nginx-demo-error.log
maxretry = 3
bantime = 1800        # 30 dakika ban
findtime = 300

# Kötü bot koruması
[nginx-badbots]
enabled = true
filter = nginx-badbots
logpath = /var/log/nginx/nginx-demo-access.log
maxretry = 2
bantime = 86400       # 24 saat ban
findtime = 600

# SQL Injection koruması
[nginx-sql-injection]
enabled = true
filter = nginx-sql-injection
logpath = /var/log/nginx/nginx-demo-access.log
maxretry = 2
bantime = 86400       # 24 saat ban
findtime = 300

# XSS koruması
[nginx-xss]
enabled = true
filter = nginx-xss
logpath = /var/log/nginx/nginx-demo-access.log
maxretry = 2
bantime = 86400       # 24 saat ban
findtime = 300

# Dosya erişim koruması
[nginx-file-access]
enabled = true
filter = nginx-file-access
logpath = /var/log/nginx/nginx-demo-access.log
maxretry = 3
bantime = 7200        # 2 saat ban
findtime = 600

# SSH koruması
[sshd]
enabled = true
port = ssh
filter = sshd
logpath = /var/log/auth.log
maxretry = 3
bantime = 3600
findtime = 600

# Güvenlik notları:
# - Her jail için uygun logpath belirtin
# - maxretry değerlerini sistem güvenliğine göre ayarlayın
# - bantime değerlerini saldırı türüne göre belirleyin
# - Düzenli olarak fail2ban loglarını kontrol edin
# - Banlanan IP'leri düzenli olarak temizleyin
